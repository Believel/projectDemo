define("/dist/courses/picture",["jquery","form","uploadify","Jcrop"],function(t,e,i){function s(){o&&o.destroy(),u.Jcrop({boxWidth:400,aspectRatio:2},function(){o=this;var t,e,i,s,u=this.ui.stage.height,n=this.ui.stage.width;t=0,i=n,e=(u-n/2)/2,s=n/2,this.newSelection(),this.setSelect([t,e,i,s]),thumbnail=this.initComponent("Thumbnailer",{width:240,height:120,thumb:".thumb"}),a(".jcrop-thumb").css({left:0,top:0})})}var a=t("jquery");t("form"),t("uploadify"),t("Jcrop");var o,u=a(".preview img");u.parent().on("cropmove cropend",function(t,e,i){a("#x").val(i.x),a("#y").val(i.y),a("#w").val(i.w),a("#h").val(i.h)}),a("#cutBtn").on("click",function(){var t=a(this).attr("data-status");return"cut"===t?(s(),a(this).val("保存图片"),void a(this).attr("data-status","save")):(a("#coordsForm").ajaxSubmit({url:"/course/crop",type:"post",success:function(t){alert(t.msg),1e4===t.code&&(location.href="/course/lesson/"+t.result.cs_id)}}),!1)}),a("#upfile").uploadify({width:"85px",height:"auto",fileObjName:"upfile",formData:{cs_id:a("#csID").val()},buttonClass:"btn btn-success btn-sm",fileSizeLimit:"2MB",fileTypeExts:"*.gif; *.jpg; *.png",buttonText:"选择图片",swf:"/assets/uploadify/uploadify.swf",uploader:"/course/upfile",itemTemplate:"<span></span>",onUploadSuccess:function(t,e){var e=JSON.parse(e);u.attr("src","/original/"+e.filename),a("#cover").val(e.filename),a("#cutBtn").prop("disabled",!1),a("#cutBtn").val("保存图片").attr("data-status","save"),s()}})});